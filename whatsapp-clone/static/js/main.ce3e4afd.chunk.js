(this["webpackJsonpreact-player"]=this["webpackJsonpreact-player"]||[]).push([[0],{57:function(e,t,s){},61:function(e,t,s){"use strict";s.r(t);var a=s(7),c=s.n(a),i=s(35),n=s.n(i),r=s(15),l=s(48),o=s(26),u=Object(o.b)({name:"auth",initialState:{isAuthenticated:!1,user:null},reducers:{login:function(e,t){var s=t.payload,a=s.uid,c=s.displayName,i=s.photoURL;e.isAuthenticated=!0,e.user={uid:a,displayName:c,photoURL:i}},logout:function(e,t){t.payload;e.isAuthenticated=!1,e.user=null}}}),d=u.actions,h=function(e){return e.auth.isAuthenticated},b=function(e){return e.auth.user},j=u.reducer,m=Object(o.b)({name:"chats",initialState:{list:[],selectedChatId:null,isLoading:!1},reducers:{setChats:function(e,t){var s=t.payload.list;e.list=s},setSelectedChatId:function(e,t){var s=t.payload.to;e.selectedChatId=s},setIsLoading:function(e,t){var s=t.payload.to;e.isLoading=s}}}),p=m.actions,f=function(e,t){return e.chats.list.find((function(e){return e.id===t}))},g=function(e){return e.chats.selectedChatId},O=function(e,t){return e.chats.list.filter((function(e){return e.name.includes(t)}))},_=function(e){return e.chats.isLoading},x=m.reducer,v=Object(o.b)({name:"common",initialState:{searchMessageInputValue:"",searchChatInputValue:""},reducers:{setSearchMessageInputValue:function(e,t){var s=t.payload.to;e.searchMessageInputValue=s},setSearchChatInputValue:function(e,t){var s=t.payload.to;e.searchChatInputValue=s}}}),y=v.actions,N=function(e){return e.common.searchMessageInputValue},C=function(e){return e.common.searchChatInputValue},w=v.reducer,V=Object(o.b)({name:"messages",initialState:{list:[],isLoading:!1},reducers:{setMessages:function(e,t){var s=t.payload.list;e.list=s},setIsLoading:function(e,t){var s=t.payload;e.isLoading=s.to}}}),I=V.actions,L=function(e){return e.messages.list},S=function(e){return e.messages.isLoading},M=V.reducer,R=Object(o.b)({name:"ui",initialState:{createChatWindowVisibility:!1,sidebarVisibility:!1,searchMessagePanelVisibility:!1},reducers:{toggleCreateChatWindowVisibility:function(e,t){t.payload;e.createChatWindowVisibility=!e.createChatWindowVisibility},toggleSidebarVisibility:function(e,t){t.payload;e.sidebarVisibility=!e.sidebarVisibility},toggleSearchMessagePanelVisibility:function(e,t){t.payload;e.searchMessagePanelVisibility=!e.searchMessagePanelVisibility},setSearchMessagePanelVisibility:function(e,t){var s=t.payload;e.searchMessagePanelVisibility=s.to},setSidebarVisibility:function(e,t){var s=t.payload;e.sidebarVisibility=s.to}}}),U=R.actions,k=function(e){return e.ui.createChatWindowVisibility},D=function(e){return e.ui.sidebarVisibility},P=function(e){return e.ui.searchMessagePanelVisibility},E=R.reducer,A=Object(o.a)({reducer:{auth:j,ui:E,common:w,chats:x,messages:M}}),W=s(0),T=s.n(W),B=s(1),F=(s(57),s(28)),z=s(13),H=s(12),G=s(5),J=function(e){return Object(G.jsx)("div",{className:"shade ".concat(!e.visibility&&"shade--hidden"),onClick:e.onClick})},K=s.p+"static/media/01.4f438702.svg",X=s.p+"static/media/02.dd463982.svg",q=s.p+"static/media/03.3990d193.svg",Q=s.p+"static/media/04.499762bc.svg",Y=s(11),Z=s(45),$=s(46),ee=s(43),te=(Object(Z.a)({apiKey:"AIzaSyDgxSLLfr3A5sLBaWXb1sGuLcW6D__Ht4g",authDomain:"whatsappclone-6dfe6.firebaseapp.com",projectId:"whatsappclone-6dfe6",storageBucket:"whatsappclone-6dfe6.appspot.com",messagingSenderId:"504293413239",appId:"1:504293413239:web:80c0a613af0cdfe6401172"}),Object($.a)()),se=Object(ee.b)(),ae=new ee.a,ce={toggleCreateChatWindowVisibility:U.toggleCreateChatWindowVisibility,setSelectedChatId:p.setSelectedChatId},ie=Object(r.b)((function(e){return{visibility:k(e)}}),ce)((function(e){var t=Object(a.useState)(""),s=Object(H.a)(t,2),c=s[0],i=s[1],n=Object(a.useState)(K),r=Object(H.a)(n,2),l=r[0],o=r[1],u=Object(a.useState)(!1),d=Object(H.a)(u,2),h=d[0],b=d[1],j=Object(a.useRef)(null),m=[K,X,q,Q];Object(a.useEffect)((function(){e.visibility&&f()}),[e.visibility]);var p=function(){var e=Object(B.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={name:c,photoURL:l,onlineList:[],lastMessage:null},e.next=3,Object(Y.a)(Object(Y.d)(te,"chats"),t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e;null===(e=j.current)||void 0===e||e.focus()},g=function(){i(""),o(K),b(!1)},O=function(){e.toggleCreateChatWindowVisibility()};return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("div",{className:"create-chat-window ".concat(!e.visibility&&"create-chat-window--hidden"),children:[Object(G.jsx)("h2",{className:"create-chat-window__title h3",children:"Create Chat"}),Object(G.jsxs)("form",{className:"create-chat-window__form",onSubmit:function(t){t.preventDefault(),c.trim()?(p().then((function(t){return s=t.id,void e.setSelectedChatId({to:s});var s})),g(),O()):b(!0)},children:[Object(G.jsx)("input",{className:"create-chat-window__chat-name-input ".concat(h&&"create-chat-window__chat-name-input--error"),value:c,onChange:function(e){return i(e.target.value)},placeholder:"Type chat name",ref:j}),Object(G.jsx)("ul",{className:"create-chat-window__photos-list",children:m.map((function(e,t){return Object(G.jsxs)("li",{className:"create-chat-window__photos-item",onClick:function(t){o(e)},children:[Object(G.jsx)("img",{src:e,className:"create-chat-window__photo ".concat(l===e&&"_create-chat-window__photo--selected")}),Object(G.jsx)("div",{className:"create-chat-window__selected-label ".concat(!(l===e)&&"create-chat-window__selected-label--hidden")})]},t)}))}),Object(G.jsx)("button",{type:"submit",className:"create-chat-window__submit-btn",children:"Create"})]})]}),Object(G.jsx)(J,{visibility:e.visibility,onClick:function(){g(),O()}})]})})),ne=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current},re={setSearchMessageInputValue:y.setSearchMessageInputValue,toggleSearchMessagePanelVisibility:U.toggleSearchMessagePanelVisibility,setSearchMessagePanelVisibility:U.setSearchMessagePanelVisibility,setSidebarVisibility:U.setSidebarVisibility},le=Object(r.b)((function(e){return{selectedChat:f(e,g(e)),searchMessageInputValue:N(e),searchMessagePanelVisibility:P(e)}}),re)((function(e){var t=Object(a.useRef)(null),s=(Object(a.useRef)((function(e){e.target.contains(t.current)})),function(){var t=Object(B.a)(T.a.mark((function t(){return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Y.e)(Object(Y.f)(te,"/chats",e.selectedChat.id));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}());Object(a.useEffect)((function(){var s;e.searchMessagePanelVisibility&&(null===(s=t.current)||void 0===s||s.focus())}),[e.searchMessagePanelVisibility]);return Object(G.jsxs)("div",{className:"chat-header",children:[Object(G.jsx)("div",{className:"chat-header__search-panel ".concat(!e.searchMessagePanelVisibility&&"chat-header__search-panel--hidden"),children:Object(G.jsx)("input",{placeholder:"Search message",className:"chat-header__search-input",value:e.searchMessageInputValue,onChange:function(t){return e.setSearchMessageInputValue({to:t.target.value})},ref:t})}),Object(G.jsxs)("div",{className:"chat-header__left",children:[Object(G.jsx)("button",{className:"chat-header__burger-menu-btn",onClick:function(){e.setSidebarVisibility({to:!0})},children:Object(G.jsx)("span",{className:"chat-header__icon chat-header__burger-icon material-icons",children:"menu"})}),Object(G.jsx)("img",{src:e.selectedChat.photoURL,className:"chat-header__photo"}),Object(G.jsx)("span",{className:"chat-header__chat-name",children:e.selectedChat.name}),Object(G.jsxs)("div",{className:"chat-header__online-panel",children:[Object(G.jsx)("span",{children:"Online:"}),Object(G.jsx)("ul",{className:"chat-header__online-list",children:e.selectedChat.onlineList.map((function(t,s){return Object(G.jsxs)("li",{className:"chat-header__online-item",children:[t,(a=s,e.selectedChat.onlineList.length!==a+1?",":null)]},s);var a}))})]})]}),Object(G.jsxs)("div",{className:"chat-header__right",children:[Object(G.jsx)("button",{className:"chat-header__btn",type:"button",onClick:function(){e.setSearchMessagePanelVisibility({to:!e.searchMessagePanelVisibility})},children:Object(G.jsx)("span",{className:"chat-header__search-icon chat-header__icon material-icons-outlined",children:"search"})}),Object(G.jsx)("button",{className:"chat-header__btn",type:"button",title:"Detete chat",onClick:function(){s()},children:Object(G.jsx)("span",{className:"chat-header__delete-icon chat-header__icon material-icons-outlined",children:"delete"})})]})]})})),oe=Object(r.b)((function(e){return{user:b(e),searchMessageInputValue:N(e)}}),{})((function(e){return Object(G.jsxs)("li",{className:"messages-item\n        ".concat(!e.belongsToCurrentUser&&"messages-item--reversed","\n        ").concat(e.belongsToCurrentUser?"messages-item--align-right":"messages-item--align-left","\n      "),children:[Object(G.jsxs)("div",{className:"messages-item__message\n          ".concat(e.belongsToCurrentUser&&"messages-item__message--green","\n          ").concat(e.searchMessageInputValue.trim()&&e.text.includes(e.searchMessageInputValue)&&"messages-item__message--blue-border","\n        "),children:[Object(G.jsx)("span",{className:"messages-item__message-author",children:e.author.displayName}),Object(G.jsx)("p",{className:"messages-item__message-text",children:e.text}),e.photoURL&&Object(G.jsx)("img",{src:e.photoURL,className:"messages-item__message-photo"}),Object(G.jsx)("span",{className:"messages-item__message-created-date",children:new Date(e.timestamp).toDateString()})]}),Object(G.jsx)("img",{src:e.author.photoURL,className:"messages-item__photo"})]})})),ue=Object(r.b)((function(e){return{}}),{})((function(e){return Object(G.jsxs)("div",{className:"photo-preview ".concat(e.isHidden&&"photo-preview--hidden"),children:[Object(G.jsx)("img",{src:e.photoURL,className:"photo-preview__photo"}),Object(G.jsx)("button",{className:"photo-preview__remove-photo-btn",onClick:e.onDeletePhotoBtnClick,type:"button",children:"Remove"})]})})),de=Object(r.b)((function(e){return{selectedChatId:g(e),user:b(e)}}),{})((function(e){var t=Object(a.useState)(""),s=Object(H.a)(t,2),c=s[0],i=s[1],n=Object(a.useState)(!0),r=Object(H.a)(n,2),l=r[0],o=r[1],u=Object(a.useState)(null),d=Object(H.a)(u,2),h=d[0],b=d[1],j=Object(a.useState)(!0),m=Object(H.a)(j,2),p=m[0],f=m[1],g=Object(a.useRef)(null),O=Object(a.useRef)(null);Object(a.useEffect)((function(){return O.current.focus()}),[e.selectedChatId]),Object(a.useEffect)((function(){c.trim()?o(!1):o(!0)}),[c]),Object(a.useEffect)((function(){h?y():v()}),[h]);var _=function(){var t=Object(B.a)(T.a.mark((function t(){var s;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={text:c,photoURL:h,author:{displayName:e.user.displayName,uid:e.user.uid,photoURL:e.user.photoURL},createdDate:Object(Y.k)(),timestamp:(new Date).getTime()},t.next=3,Object(Y.a)(Object(Y.d)(te,"chats/".concat(e.selectedChatId,"/messages")),s);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),x=function(){var t=Object(B.a)(T.a.mark((function t(){return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Y.l)(Object(Y.f)(te,"/chats/".concat(e.selectedChatId)),{lastMessage:{authorDisplayName:e.user.displayName,text:c}});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(){f(!0)},y=function(){f(!1)};return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("form",{className:"send-message-form",onSubmit:function(e){e.preventDefault(),_(),x(),b(null),i(""),g.current.value=null},children:[Object(G.jsx)(ue,{photoURL:h,isHidden:p,onDeletePhotoBtnClick:function(){b(null),g.current.value=null}}),Object(G.jsx)("button",{className:"send-message-form__select-photo-btn",type:"button",onClick:function(){g.current.click()},children:Object(G.jsx)("span",{className:"send-message-form__photo-icon material-icons-outlined ".concat(h&&"send-message-form__photo-icon--file--selected"),children:"photo_size_select_actual"})}),Object(G.jsxs)("div",{className:"send-message-form__message-input-panel",children:[Object(G.jsx)("input",{className:"send-message-form__message-input",value:c,onChange:function(e){return i(e.target.value)},placeholder:"Type message",ref:O}),Object(G.jsx)("button",{type:"submit",className:"send-message-form__submit-btn ".concat(l&&"send-message-form__submit-btn--hidden"),children:Object(G.jsx)("span",{className:"send-message-form__send-icon material-icons",children:"send"})})]})]}),Object(G.jsx)("input",{type:"file",hidden:!0,ref:g,onChange:function(e){!function(e){var t=new FileReader;t.readAsDataURL(e.files[0]),t.onload=function(){b(t.result)}}(e.target)}})]})})),he={setIsLoading:I.setIsLoading,setMessages:I.setMessages},be=Object(r.b)((function(e){return{isLoading:S(e),messages:L(e),selectedChatId:g(e),user:b(e),searchMessageInputValue:N(e)}}),he)((function(e){var t=ne(e.selectedChatId),s=Object(a.useRef)(null);return Object(a.useEffect)((function(){return e.setIsLoading({to:!0})}),[e.selectedChatId]),Object(a.useEffect)((function(){e.setMessages({list:[]});var t=Object(Y.j)(Object(Y.d)(te,"chats/".concat(e.selectedChatId,"/messages")),Object(Y.i)("createdDate")),s=Object(Y.h)(t,(function(t){var s=[];t.forEach((function(e){var t,a=e.data(),c={id:e.id,text:a.text,photoURL:a.photoURL,createdDate:{seconds:null===(t=a.createdDate)||void 0===t?void 0:t.seconds},author:{displayName:a.author.displayName,uid:a.author.uid,photoURL:a.author.photoURL},timestamp:a.timestamp};s.push(c)})),e.setMessages({list:s}),e.setIsLoading({to:!1})}));return function(){return s()}}),[e.selectedChatId]),Object(a.useEffect)(Object(B.a)(T.a.mark((function s(){return T.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(Y.l)(Object(Y.f)(te,"/chats/".concat(e.selectedChatId)),{onlineList:Object(Y.c)(e.user.displayName)});case 2:if(!t){s.next=5;break}return s.next=5,Object(Y.l)(Object(Y.f)(te,"/chats/".concat(t)),{onlineList:Object(Y.b)(e.user.displayName)});case 5:case"end":return s.stop()}}),s)}))),[e.selectedChatId]),Object(a.useEffect)((function(){s.current.scrollTo(0,s.current.scrollHeight)}),[e.messages]),Object(G.jsxs)("div",{className:"chat",children:[Object(G.jsx)(le,{}),Object(G.jsxs)("div",{className:"chat__body",ref:s,children:[e.isLoading&&Object(G.jsx)("div",{className:"chat__loader"}),Object(G.jsx)("ul",{className:"chat__messages-list",children:e.messages.map((function(t){return Object(G.jsx)(oe,{text:t.text,photoURL:t.photoURL,createdDate:t.createdDate,author:t.author,belongsToCurrentUser:t.author.uid===e.user.uid,timestamp:t.timestamp},t.id)}))})]}),Object(G.jsx)(de,{})]})})),je={toggleSidebarVisibility:U.toggleSidebarVisibility},me=Object(r.b)((function(e){return{sidebarVisibility:D(e)}}),je)((function(e){return Object(G.jsxs)("div",{className:"intro",children:[Object(G.jsx)("img",{src:"https://web.telegram.org/z/favicon.svg",className:"intro__logo"}),Object(G.jsx)("h1",{className:"intro__title h4",children:"Welcome to Telegram clone"}),Object(G.jsx)("button",{className:"intro__select-chat-btn",onClick:function(){e.toggleSidebarVisibility()},children:"Select chat"})]})})),pe={setSelectedChatId:p.setSelectedChatId},fe=Object(r.b)((function(e){return{}}),pe)((function(e){return Object(G.jsxs)("li",{className:"chats-item ".concat(e.isActive&&"chats-item--selected"),onClick:function(){e.setSelectedChatId({to:e.id})},children:[Object(G.jsx)("img",{src:e.photoURL,className:"chats-item__photo"}),Object(G.jsx)("span",{className:"chats-item__name",children:e.name}),Object(G.jsx)("span",{className:"chats-item__last-message",children:e.lastMessage?Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("span",{className:"chats-item__last-message-author",children:[e.lastMessage.authorDisplayName,": "," "]}),Object(G.jsx)("span",{className:"chats-item__last-message-text",children:e.lastMessage.text})]}):"Tap to open"})]})})),ge={toggleCreateChatWindowVisibility:U.toggleCreateChatWindowVisibility,setIsLoading:p.setIsLoading,setSearchChatInputValue:y.setSearchChatInputValue,setChats:p.setChats,toggleVisibility:U.toggleSidebarVisibility,setSidebarVisibility:U.setSidebarVisibility},Oe=Object(r.b)((function(e){return{user:b(e),selectedChatId:g(e),isLoading:_(e),filteredChats:O(e,C(e)),searchChatInputValue:C(e),visibility:D(e)}}),ge)((function(e){var t=Object(a.useRef)(null);Object(a.useEffect)((function(){e.setIsLoading({to:!0})}),[]),Object(a.useEffect)((function(){var t=Object(Y.j)(Object(Y.d)(te,"chats")),s=Object(Y.h)(t,(function(t){var s=[];t.forEach((function(e){var t=e.id,a=e.data(),c=a.name,i=a.lastMessage,n=a.onlineList,r=a.photoURL;s.push({id:t,name:c,lastMessage:i,onlineList:n,photoURL:r})})),e.setChats({list:s}),e.setIsLoading({to:!1})}));return function(){return s()}}),[]);var s=function(){e.setSidebarVisibility({to:!1})};return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("div",{className:"sidebar ".concat(!e.visibility&&"sidebar--hidden"),children:[Object(G.jsxs)("div",{className:"sidebar__header",children:[Object(G.jsxs)("div",{className:"sidebar__header-left",children:[Object(G.jsx)("img",{className:"sidebar__header-avatar",src:e.user.photoURL}),Object(G.jsx)("span",{className:"sidebar__header-display-name",children:e.user.displayName}),Object(G.jsx)("span",{className:"sidebar__header-status",children:"Online"})]}),Object(G.jsx)("button",{className:"sidebar__logout-btn",onClick:function(){Object(F.e)(se)},children:Object(G.jsx)("span",{className:"sidebar__logout-icon material-icons-outlined",children:"logout"})})]}),Object(G.jsx)("div",{className:"sidebar__search-panel-wrapper",children:Object(G.jsx)("div",{className:"sidebar__search-panel",ref:t,children:Object(G.jsx)("span",{className:"sidebar__search-icon material-icons-outlined",children:"search"})})}),e.isLoading&&Object(G.jsx)("div",{className:"sidebar__loader"}),Object(G.jsx)("ul",{className:"sidebar__chats-list",children:e.filteredChats.map((function(t){return Object(G.jsx)(fe,{id:t.id,name:t.name,lastMessage:t.lastMessage,photoURL:t.photoURL,isActive:e.selectedChatId===t.id},t.id)}))}),Object(G.jsx)("button",{className:"sidebar__add-chat-btn",type:"button",onClick:function(){e.toggleCreateChatWindowVisibility(),s()},children:"Add new chat"})]}),Object(G.jsx)(J,{visibility:e.visibility,onClick:function(){s()}})]})})),_e=Object(r.b)((function(e){return{isAuthenticated:h(e),selectedChat:f(e,g(e))}}),{})((function(e){return e.isAuthenticated?Object(G.jsx)("div",{className:"home-page",children:Object(G.jsxs)("div",{className:"home-page__body",children:[Object(G.jsx)(Oe,{}),e.selectedChat?Object(G.jsx)(be,{}):Object(G.jsx)(me,{})]})}):null})),xe=Object(r.b)((function(e){return{isAuthenticated:h(e)}}),{})((function(e){if(e.isAuthenticated)return null;return Object(G.jsx)("div",{className:"login-page",children:Object(G.jsxs)("div",{className:"login-page__body",children:[Object(G.jsx)("img",{className:"login-page__logo",src:"https://web.telegram.org/z/favicon.svg"}),Object(G.jsx)("h1",{className:"login-page__title h4",children:"Sign in to Telegram"}),Object(G.jsx)("button",{className:"login-page__sign-in-btn",onClick:function(){Object(F.d)(se,ae)},children:"Sign in with Google"})]})})})),ve={login:d.login,logout:d.logout},ye=Object(r.b)((function(e){return{selectedChatId:g(e),user:b(e)}}),ve)((function(e){var t=Object(z.g)();return Object(a.useEffect)((function(){Object(F.c)(se,(function(s){if(s){var a=s.uid,c=s.photoURL,i=s.displayName;e.login({uid:a,photoURL:c,displayName:i}),t.push("/home")}else e.logout(),t.push("/login")}))}),[]),Object(a.useEffect)((function(){window.addEventListener("beforeunload",function(){var t=Object(B.a)(T.a.mark((function t(s){return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Y.l)(Object(Y.f)(te,"/chats/".concat(e.selectedChatId)),{onlineList:Object(Y.b)(e.user.displayName)});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[]),Object(G.jsxs)("div",{className:"app",children:[Object(G.jsxs)(z.d,{children:[Object(G.jsx)(z.b,{path:"/",exact:!0,children:Object(G.jsx)(z.a,{to:"/home"})}),Object(G.jsx)(z.b,{path:"/login",children:Object(G.jsx)(xe,{})}),Object(G.jsx)(z.b,{path:"/home",children:Object(G.jsx)(_e,{})})]}),Object(G.jsx)(ie,{})]})}));n.a.render(Object(G.jsx)(c.a.StrictMode,{children:Object(G.jsx)(l.a,{basename:"/whatsapp-clone",children:Object(G.jsx)(r.a,{store:A,children:Object(G.jsx)(ye,{})})})}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.ce3e4afd.chunk.js.map